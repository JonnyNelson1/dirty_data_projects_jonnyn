---
title: "Analysis and Questions"
author: "Jonny Nelson"
date: "24/11/2021"
output: html_document
---

# Loading in packages

```{r}
library(tidyverse)
```


# Loading in the clean_data

```{r}

candy_clean <- read_csv(here("clean_data/candy_clean.csv"))

```

# Analysis Questions


```{r}

# 1. What is the total number of candy ratings given across the three years. (Number of candy ratings, not the number of raters. Donâ€™t count missing values)

candy_clean %>%
  select(entry, rating) %>%
  drop_na(rating) %>%
  summarise(count = n())


```

```{r}

# 2. What was the average age of people who are going out trick or treating?

candy_clean %>%
  select(entry, age, going_out) %>%
  filter(going_out == "Yes") %>%
  drop_na(age) %>%
  summarise(average_age_of_people = mean(age))

```


```{r}

# 2. What was the average age of people who are going out trick or treating?

candy_clean %>%
  select(entry, age, going_out) %>%
  filter(going_out == "No") %>%
  drop_na(age) %>%
  summarise(average_age_of_people = mean(age))

```

```{r}

# 4. For each of joy, despair and meh, which candy bar revived the most of these ratings?

# Can use the function unique() to find all values in rating

unique(candy_clean$rating)

# JOY

candy_clean %>%
  select(entry, rating, candy_name) %>%
  filter(rating == "JOY") %>%
  drop_na(rating) %>%
  count(rating)

# DESPAIR

candy_clean %>%
  select(entry, rating, candy_name) %>%
  filter(rating == "DESPAIR") %>%
  drop_na(rating) %>%
  count(rating)

# MEH

candy_clean %>%
  select(entry, rating, candy_name) %>%
  filter(rating == "MEH") %>%
  drop_na(rating) %>%
  count(rating)

```

```{r}

# 5. How many people rated Starburst as despair?

candy_clean %>%
  select(entry, rating, candy_name) %>%
  filter(rating == "DESPAIR" & candy_name == "starburst") %>%
  count()

```

```{r}

# For the next three questions, count despair as -1, joy as +1, and meh as 0.

recoded_candy_clean <- candy_clean %>%
  select(entry, gender, rating, candy_name, country, province) %>%
  mutate(rating = recode(rating, "JOY" = 1, "MEH" = 0, "DESPAIR" = -1,))

```

```{r}

# 6. What was the most popular candy bar by this rating system for each gender in the dataset ?

recoded_candy_clean %>%
  select(entry, rating, candy_name, gender) %>%
  drop_na(rating) %>%
  group_by(gender) %>%
    candy_popularity_by_gender = case_when(
      gender == "Male" ~ sum(rating),
      gender == "Female" ~ sum(rating),
      TRUE ~ sum(rating)
    )
  )
```



